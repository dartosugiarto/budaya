<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="color-scheme" content="light dark" />
<title>Player</title>
<style>
:root{--bg:#0b0d10;--fg:#e8eaed;--muted:#9aa3b2;--ring:#222834;--accent:#e50914}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.container{max-width:920px;margin:0 auto;padding:18px}
.header{display:flex;gap:12px;align-items:center}
.title{font-weight:800}
.select{margin-left:auto}
.player{margin-top:14px;border:1px solid var(--ring);border-radius:12px;overflow:hidden;background:#000;aspect-ratio:16/9;position:relative}
video{width:100%;height:100%}
.controls{display:flex;gap:8px;margin-top:12px}
button{border:1px solid var(--ring);background:#12161d;color:var(--fg);border-radius:10px;padding:8px 12px;cursor:pointer}
.meta{margin-top:8px;color:var(--muted);font-size:13px}
.notice{margin-top:14px;font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="title">Video</div>
    <select id="picker" class="select"></select>
  </div>

  <div class="player">
    <video id="video" controls playsinline preload="metadata" poster="" ></video>
  </div>

  <div class="controls">
    <button id="back10">⟲ 10 dtk</button>
    <button id="fwd10">10 dtk ⟳</button>
    <button id="mute">Mute</button>
  </div>

  <div class="meta" id="meta"></div>
  <div class="notice">Catatan: Link Drive langsung bisa kena batas kuota. Untuk traffic tinggi, pakai proxy atau CDN/HLS.</div>
</div>

<script>
const useProxy=false
const proxyBase='https://your-worker.your-domain.workers.dev'
const videos=[
  {
    id:'v1',
    title:'Contoh 1',
    driveId:'REPLACE_WITH_FILE_ID',
    poster:''
  },
  {
    id:'v2',
    title:'Contoh 2',
    driveId:'REPLACE_WITH_FILE_ID',
    poster:''
  }
]

const elPicker=document.getElementById('picker')
const elVideo=document.getElementById('video')
const elMeta=document.getElementById('meta')
const key='play:progress:'
let current=videos[0]

function driveDirectUrl(driveId){return `https://drive.google.com/uc?id=${driveId}&export=download`}
function proxyUrl(driveId){return `${proxyBase}/stream/${driveId}`}

function loadList(){
  elPicker.innerHTML=''
  videos.forEach((v,i)=>{
    const o=document.createElement('option')
    o.value=v.id
    o.textContent=v.title
    if(i===0) o.selected=true
    elPicker.appendChild(o)
  })
}

function loadProgress(id){
  try{
    const raw=localStorage.getItem(key+id)
    if(!raw) return 0
    const {t,d}=JSON.parse(raw)
    if(!d||d<=0) return 0
    return Math.max(0,Math.min(t/d,0.98))
  }catch(e){return 0}
}

function saveProgress(id,video){
  try{
    localStorage.setItem(key+id,JSON.stringify({t:video.currentTime||0,d:video.duration||0}))
  }catch(e){}
}

function setSource(item){
  current=item
  const url=useProxy?proxyUrl(item.driveId):driveDirectUrl(item.driveId)
  elVideo.src=url
  elVideo.poster=item.poster||''
  elMeta.textContent=item.title
  const p=loadProgress(item.id)
  if(p>0){
    elVideo.addEventListener('loadedmetadata',function seeker(){
      elVideo.currentTime=(elVideo.duration||0)*p
      elVideo.removeEventListener('loadedmetadata',seeker)
    })
  }
}

document.getElementById('back10').onclick=()=>{elVideo.currentTime=Math.max(0,elVideo.currentTime-10)}
document.getElementById('fwd10').onclick=()=>{elVideo.currentTime=Math.min(elVideo.duration||Infinity,elVideo.currentTime+10)}
document.getElementById('mute').onclick=()=>{elVideo.muted=!elVideo.muted}

elPicker.addEventListener('change',e=>{
  const next=videos.find(v=>v.id===e.target.value)
  if(next) setSource(next)
})

elVideo.addEventListener('timeupdate',()=>saveProgress(current.id,elVideo))
elVideo.addEventListener('ended',()=>saveProgress(current.id,elVideo))

loadList()
setSource(current)
</script>
</body>
</html>
